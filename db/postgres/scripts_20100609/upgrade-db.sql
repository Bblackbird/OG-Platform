-- IMPORTANT:
--
-- This file was generated by concatenating the three other .sql files together. It can be
-- used for testing, but the separate SQL sequences will be necessary if the Security Master
-- and Position Master need to be installed in different databases.
--
-- Please do not modify it - modify the originals and recreate this using 'ant create-db-sql'.


-- upgrade-db-security.sql: Security Master

alter table sec_option drop constraint sec_fk_option2currency1;
alter table sec_option drop constraint sec_fk_option2currency2;
alter table sec_option drop constraint sec_fk_option2currency3;

alter table sec_option rename column currency1_id to currency_id;
alter table sec_option rename column currency2_id to put_currency_id;
alter table sec_option rename column currency3_id to call_currency_id;

alter table sec_option add constraint sec_fk_option2currency foreign key (currency_id) references sec_currency (id);
alter table sec_option add constraint sec_fk_option2putcurrency foreign key (put_currency_id) references sec_currency (id);
alter table sec_option add constraint sec_fk_option2callcurrency foreign key (call_currency_id) references sec_currency (id);

alter table sec_option drop column underlyingIdentityKey;
alter table sec_option add column underlying_scheme varchar(255);
alter table sec_option add column underlying_identifier varchar(255);
    

-- upgrade-db-common.sql: Standard Hibernate required by Security Master and Position Master
  
-- No action
