<project name="client-impl" xmlns:ivy="antlib:org.apache.ivy.ant">

	<property file="build.properties"/>
	<import file="${common.dir}/common.xml"/>

	<target name="proto-c" description="--> generates the C/C++ header files for the Fudge messages" unless="proto.c.disabled">
		<java classname="org.fudgemsg.proto.CommandLine" classpathref="run.path.id" fork="true">
			<arg value="-d${project.dir}/Connector" />
			<arg value="-lC" />
			<arg value="-Xinclude=stdafx.h" />
			<arg value="-s${src.dir}" />
			<arg value="${src.dir}/com/opengamma/language/Data.proto" />
			<arg value="${src.dir}/com/opengamma/language/connector/ConnectorMessage.proto" />
			<arg value="${src.dir}/com/opengamma/language/connector/Test.proto" />
		</java>
	</target>

	<target name="deploy" depends="jar,proto-c" description="--> generates files into C++ project folders">
		<copy file="${project.dir}/config/Client.properties" todir="${build.dir}" failonerror="true" />
		<copy file="${project.dir}/config/Client.xml" todir="${build.dir}" failonerror="true" />
		<copy file="${project.dir}/config/logback.xml" todir="${build.dir}" failonerror="false" />
		<mkdir dir="${build.dir}/jar" />
		<ivy:retrieve pattern="${build.dir}/jar/[organization]-[module]-[artifact].[ext]" type="jar" />
	</target>

</project>
