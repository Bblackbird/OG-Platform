/**
 * Copyright (C) 2009 - present by OpenGamma Inc. and the OpenGamma group of companies
 *
 * Please see distribution for license.
 */
package com.opengamma.financial.convention;

import java.util.ArrayList;
import java.util.Collection;

import javax.time.calendar.Period;

import com.opengamma.core.region.RegionUtils;
import com.opengamma.core.security.SecurityUtils;
import com.opengamma.financial.convention.businessday.BusinessDayConvention;
import com.opengamma.financial.convention.businessday.BusinessDayConventionFactory;
import com.opengamma.financial.convention.daycount.DayCount;
import com.opengamma.financial.convention.daycount.DayCountFactory;
import com.opengamma.financial.convention.frequency.Frequency;
import com.opengamma.financial.convention.frequency.SimpleFrequencyFactory;
import com.opengamma.financial.convention.yield.SimpleYieldConvention;
import com.opengamma.financial.convention.yield.YieldConvention;
import com.opengamma.id.IdentificationScheme;
import com.opengamma.id.Identifier;
import com.opengamma.id.IdentifierBundle;
import com.opengamma.id.IdentifierBundleMapper;
import com.opengamma.id.UniqueIdentifier;

/**
 * An in-memory, statically initialized master for convention bundles and their meta-data.
 */
public class InMemoryConventionBundleMaster implements ConventionBundleMaster {

  /**
   * IdentificationScheme to use when specifying rates with simple descriptions e.g. 'LIBOR O/N', 'LIBOR 1w' etc.
   */
  public static final IdentificationScheme SIMPLE_NAME_SCHEME = IdentificationScheme.of("Reference Rate Simple Name");

  /**
   * IdentificationScheme of the unique identifiers generated by this repository.
   */
  public static final IdentificationScheme IN_MEMORY_UNIQUE_SCHEME = IdentificationScheme.of("In-memory Reference Rate unique");
  /**
   * Data store for the conventions.
   */
  private final IdentifierBundleMapper<ConventionBundle> _mapper = new IdentifierBundleMapper<ConventionBundle>(IN_MEMORY_UNIQUE_SCHEME.getName());

  /**
   * Creates an instance.
   */
  public InMemoryConventionBundleMaster() {
    addUSDFixedIncomeInstruments();
    addGBPFixedIncomeInstruments();
    addEURFixedIncomeInstruments();
    addJPYFixedIncomeInstruments();
    addCADFixedIncomeInstruments();
    addAUDFixedIncomeInstruments();
    addCHFFixedIncomeInstruments();
    addUSDCAPMDefinition();
    addUSTreasuryBondConvention();
    addUSCorporateBondConvention();
    addGBTreasuryBondConvention();
    addGBCorporateBondConvention();
    addLUTreasuryBondConvention();
    addLUCorporateBondConvention();
    addBHTreasuryBondConvention();
    addBHCorporateBondConvention();
    addSETreasuryBondConvention();
    addSECorporateBondConvention();
    addDKTreasuryBondConvention();
    addDKCorporateBondConvention();
    addFRTreasuryBondConvention();
    addFRCorporateBondConvention();
    addCHTreasuryBondConvention();
    addCHCorporateBondConvention();
    addPLTreasuryBondConvention();
    addPLCorporateBondConvention();
    addESTreasuryBondConvention();
    addESCorporateBondConvention();
    addNLTreasuryBondConvention();
    addNLCorporateBondConvention();
    addDETreasuryBondConvention();
    addDECorporateBondConvention();
    addITTreasuryBondConvention();
    addITCorporateBondConvention();
    addHUTreasuryBondConvention();
    addHUCorporateBondConvention();
    addUSDBondFutureConvention();
    addGBPBondFutureConvention();
  }

  //-------------------------------------------------------------------------
  @Override
  public synchronized UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final DayCount dayCount, final BusinessDayConvention businessDayConvention,
      final Frequency frequency, final int settlementDays) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(bundle, name, dayCount, businessDayConvention, frequency, settlementDays);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public synchronized UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final DayCount dayCount, final BusinessDayConvention businessDayConvention,
      final Frequency frequency, final int settlementDays, final double yearFraction) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(bundle, name, dayCount, businessDayConvention, frequency, settlementDays, yearFraction);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public synchronized UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final DayCount dayCount, final BusinessDayConvention businessDayConvention,
      final Period period, final int settlementDays) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(bundle, name, dayCount, businessDayConvention, period, settlementDays);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public synchronized UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final DayCount swapFixedLegDayCount,
      final BusinessDayConvention swapFixedLegBusinessDayConvention, final Frequency swapFixedLegFrequency, final Integer swapFixedLegSettlementDays, final Identifier swapFixedLegRegion,
      final DayCount swapFloatingLegDayCount, final BusinessDayConvention swapFloatingLegBusinessDayConvention, final Frequency swapFloatingLegFrequency, final Integer swapFloatingLegSettlementDays,
      final Identifier swapFloatingLegInitialRate, final Identifier swapFloatingLegRegion) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(bundle, name, swapFixedLegDayCount, swapFixedLegBusinessDayConvention, swapFixedLegFrequency, swapFixedLegSettlementDays,
        swapFixedLegRegion, swapFloatingLegDayCount, swapFloatingLegBusinessDayConvention, swapFloatingLegFrequency, swapFloatingLegSettlementDays, swapFloatingLegInitialRate, swapFloatingLegRegion);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final DayCount basisSwapPayFloatingLegDayCount,
      final BusinessDayConvention basisSwapPayFloatingLegBusinessDayConvention, final Frequency basisSwapPayFloatingLegFrequency, final Integer basisSwapPayFloatingLegSettlementDays,
      final Identifier basisSwapPayFloatingLegInitialRate, final Identifier basisSwapPayFloatingLegRegion, final DayCount basisSwapReceiveFloatingLegDayCount,
      final BusinessDayConvention basisSwapReceiveFloatingLegBusinessDayConvention, final Frequency basisSwapReceiveFloatingLegFrequency, final Integer basisSwapReceiveFloatingLegSettlementDays,
      final Identifier basisSwapReceiveFloatingLegInitialRate, final Identifier basisSwapReceiveFloatingLegRegion) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(bundle, name, basisSwapPayFloatingLegDayCount, basisSwapPayFloatingLegBusinessDayConvention, basisSwapPayFloatingLegFrequency,
        basisSwapPayFloatingLegSettlementDays, basisSwapPayFloatingLegInitialRate, basisSwapPayFloatingLegRegion, basisSwapReceiveFloatingLegDayCount,
        basisSwapReceiveFloatingLegBusinessDayConvention, basisSwapReceiveFloatingLegFrequency, basisSwapReceiveFloatingLegSettlementDays, basisSwapReceiveFloatingLegInitialRate,
        basisSwapReceiveFloatingLegRegion);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public synchronized UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final String capmRiskFreeRateName, final String capmMarketName) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(name, capmRiskFreeRateName, capmMarketName);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public synchronized UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final boolean isEOMConvention, final boolean calculateScheduleFromMaturity,
      final int exDividendDays, final int settlementDays, final boolean rollToSettlement) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(name, isEOMConvention, calculateScheduleFromMaturity, exDividendDays, settlementDays, rollToSettlement);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public synchronized UniqueIdentifier addConventionBundle(final IdentifierBundle bundle, final String name, final boolean isEOMConvention, final boolean calculateScheduleFromMaturity,
      final int exDividendDays, final int settlementDays, final DayCount dayCount, final BusinessDayConvention businessDayConvention, final YieldConvention yieldConvention) {
    final ConventionBundleImpl convention = new ConventionBundleImpl(name, isEOMConvention, calculateScheduleFromMaturity, exDividendDays, settlementDays, dayCount, businessDayConvention,
        yieldConvention);
    final UniqueIdentifier uid = _mapper.add(bundle, convention);
    convention.setUniqueId(uid);
    return uid;
  }

  @Override
  public ConventionBundleDocument getConventionBundle(final UniqueIdentifier uniqueId) {
    return new ConventionBundleDocument(_mapper.get(uniqueId));
  }

  @Override
  public ConventionBundleSearchResult searchConventionBundle(final ConventionBundleSearchRequest request) {
    final Collection<ConventionBundle> collection = _mapper.get(request.getIdentifiers());
    return new ConventionBundleSearchResult(wrapReferenceRatesWithDocuments(collection));
  }

  @Override
  public ConventionBundleSearchResult searchHistoricConventionBundle(final ConventionBundleSearchHistoricRequest request) {
    final Collection<ConventionBundle> collection = _mapper.get(request.getIdentifiers());
    return new ConventionBundleSearchResult(wrapReferenceRatesWithDocuments(collection));
  }

  private Collection<ConventionBundleDocument> wrapReferenceRatesWithDocuments(final Collection<ConventionBundle> referenceRates) {
    final Collection<ConventionBundleDocument> results = new ArrayList<ConventionBundleDocument>(referenceRates.size());
    for (final ConventionBundle referenceRate : referenceRates) {
      results.add(new ConventionBundleDocument(referenceRate));
    }
    return results;
  }

  private void addUSDFixedIncomeInstruments() {
    // NOTE THESE ONLY APPLY TO US LIBOR RATES
    final BusinessDayConvention modified = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Modified Following");
    final BusinessDayConvention following = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following");
    final DayCount act360 = DayCountFactory.INSTANCE.getDayCount("Actual/360");
    final DayCount thirty360 = DayCountFactory.INSTANCE.getDayCount("30/360");
    //    final Frequency freq = null;
    final Frequency semiAnnual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.SEMI_ANNUAL_NAME);
    final Frequency quarterly = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.QUARTERLY_NAME);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US00O/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR O/N")), "USD LIBOR O/N", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US00T/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR T/N")), "USD LIBOR T/N", act360, following,
        Period.ofDays(1), 1);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0001W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 1w")), "USD LIBOR 1w", act360, following,
        Period.ofDays(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0002W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 2w")), "USD LIBOR 2w", act360, following,
        Period.ofDays(14), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0001M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 1m")), "USD LIBOR 1m", act360, modified,
        Period.ofMonths(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0002M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 2m")), "USD LIBOR 2m", act360, modified,
        Period.ofMonths(2), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0003M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 3m")), "USD LIBOR 3m", act360, modified,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0004M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 4m")), "USD LIBOR 4m", act360, modified,
        Period.ofMonths(4), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0005M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 5m")), "USD LIBOR 5m", act360, modified,
        Period.ofMonths(5), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0006M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 6m")), "USD LIBOR 6m", act360, modified,
        Period.ofMonths(6), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0007M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 7m")), "USD LIBOR 7m", act360, modified,
        Period.ofMonths(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0008M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 8m")), "USD LIBOR 8m", act360, modified,
        Period.ofMonths(8), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0009M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 9m")), "USD LIBOR 9m", act360, modified,
        Period.ofMonths(9), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0010M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 10m")), "USD LIBOR 10m", act360, modified,
        Period.ofMonths(10), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0011M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 11m")), "USD LIBOR 11m", act360, modified,
        Period.ofMonths(11), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("US0012M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 12m")), "USD LIBOR 12m", act360, modified,
        Period.ofMonths(12), 2);

    //TODO need to check that these are right for deposit rates
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR1T Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 1d")), "USD DEPOSIT 1d", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR2T Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 2d")), "USD DEPOSIT 2d", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR3T Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 3d")), "USD DEPOSIT 3d", act360, following,
        Period.ofDays(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR7D Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 1w")), "USD DEPOSIT 1w", act360, following,
        Period.ofDays(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR2Z Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 2w")), "USD DEPOSIT 2w", act360, following,
        Period.ofDays(14), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR3Z Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 3w")), "USD DEPOSIT 3w", act360, following,
        Period.ofDays(21), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRA Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 1m")), "USD DEPOSIT 1m", act360, following,
        Period.ofMonths(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRB Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 2m")), "USD DEPOSIT 2m", act360, following,
        Period.ofMonths(2), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRC Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 3m")), "USD DEPOSIT 3m", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRD Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 4m")), "USD DEPOSIT 4m", act360, following,
        Period.ofMonths(4), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRE Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 5m")), "USD DEPOSIT 5m", act360, following,
        Period.ofMonths(5), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRF Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 6m")), "USD DEPOSIT 6m", act360, following,
        Period.ofMonths(6), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRG Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 7m")), "USD DEPOSIT 7m", act360, following,
        Period.ofMonths(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRH Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 8m")), "USD DEPOSIT 8m", act360, following,
        Period.ofMonths(8), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRI Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 9m")), "USD DEPOSIT 9m", act360, following,
        Period.ofMonths(9), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRJ Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 10m")), "USD DEPOSIT 10m", act360, following,
        Period.ofMonths(10), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRK Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 11m")), "USD DEPOSIT 11m", act360, following,
        Period.ofMonths(11), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDRL Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 12m")), "USD DEPOSIT 12m", act360, following,
        Period.ofMonths(12), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR1 Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 1y")), "USD DEPOSIT 1y", act360, following,
        Period.ofYears(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR2 Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 2y")), "USD DEPOSIT 2y", act360, following,
        Period.ofYears(2), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR3 Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 3y")), "USD DEPOSIT 3y", act360, following,
        Period.ofYears(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR4 Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 4y")), "USD DEPOSIT 4y", act360, following,
        Period.ofYears(4), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USDR5 Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD DEPOSIT 5y")), "USD DEPOSIT 5y", act360, following,
        Period.ofYears(5), 2);

    //TODO check that this is ok for FRA
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR00C Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 3x3")), "USD FRA 3x3", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR0CF Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 6x9")), "USD FRA 6x9", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR0FI Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 9x12")), "USD FRA 9x12", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR0I1 Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 12x15")), "USD FRA 12x15", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR011C Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 15x18")), "USD FRA 15x18", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR1C1F Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 18x21")), "USD FRA 18x21", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR1F1I Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 21x24")), "USD FRA 21x24", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("USFR1I2 Curncy"), Identifier.of(SIMPLE_NAME_SCHEME, "USD FRA 24x27")), "USD FRA 24x27", act360, following,
        Period.ofMonths(3), 2);

    //TODO with improvement in settlement days definition (i.e. including holiday and adjustment) change this
    // should be 2, LON, following
    // holiday for swap should be NY+LON
    final Identifier usgb = RegionUtils.financialRegionId("US+GB");
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "USD_SWAP")), "USD_SWAP", thirty360, modified, semiAnnual, 2, usgb, act360, modified, quarterly, 2,
        Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 3m"), usgb);

    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "USD_TENOR_SWAP")), "USD_TENOR_SWAP", act360, modified, quarterly, 2, Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 3m"),
        usgb, act360, modified, quarterly, 2, Identifier.of(SIMPLE_NAME_SCHEME, "USD LIBOR 3m"), usgb);
    Period nullPeriod = null;
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "USD_FRA")), "USD_FRA", act360, following, nullPeriod, 2);

    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "USD_IRFUTURE")), "USD_IRFUTURE", act360, following, null, 2, 0.25);
  }

  private void addEURFixedIncomeInstruments() {
    final BusinessDayConvention modified = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Modified Following");
    final BusinessDayConvention following = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following");
    final DayCount act360 = DayCountFactory.INSTANCE.getDayCount("Actual/360");
    final DayCount thirty360 = DayCountFactory.INSTANCE.getDayCount("30/360");
    final Frequency annual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.ANNUAL_NAME);
    final Frequency semiAnnual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.SEMI_ANNUAL_NAME);
    final Frequency quarterly = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.QUARTERLY_NAME);
    //TODO looked at BSYM and the codes seem right but need to check
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU00O/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR O/N")), "EUR LIBOR O/N", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU00T/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR T/N")), "EUR LIBOR T/N", act360, following,
        Period.ofDays(1), 1);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0001W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 1w")), "EUR LIBOR 1w", act360, following,
        Period.ofDays(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0002W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 2w")), "EUR LIBOR 2w", act360, following,
        Period.ofDays(14), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0001M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 1m")), "EUR LIBOR 1m", act360, modified,
        Period.ofMonths(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0002M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 2m")), "EUR LIBOR 2m", act360, modified,
        Period.ofMonths(2), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0003M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 3m")), "EUR LIBOR 3m", act360, modified,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0004M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 4m")), "EUR LIBOR 4m", act360, modified,
        Period.ofMonths(4), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0005M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 5m")), "EUR LIBOR 5m", act360, modified,
        Period.ofMonths(5), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0006M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 6m")), "EUR LIBOR 6m", act360, modified,
        Period.ofMonths(6), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0007M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 7m")), "EUR LIBOR 7m", act360, modified,
        Period.ofMonths(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0008M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 8m")), "EUR LIBOR 8m", act360, modified,
        Period.ofMonths(8), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0009M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 9m")), "EUR LIBOR 9m", act360, modified,
        Period.ofMonths(9), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0010M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 10m")), "EUR LIBOR 10m", act360, modified,
        Period.ofMonths(10), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0011M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 11m")), "EUR LIBOR 11m", act360, modified,
        Period.ofMonths(11), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("EU0012M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 12m")), "EUR LIBOR 12m", act360, modified,
        Period.ofMonths(12), 2);

    //TODO holiday associated with EUR swaps is TARGET
    final Identifier eu = RegionUtils.financialRegionId("EU");
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "EUR_SWAP")), "EUR_SWAP", thirty360, modified, annual, 2, eu, act360, modified, semiAnnual, 2,
        Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 6m"), eu);
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "EUR_1Y_SWAP")), "EUR_1Y_SWAP", thirty360, modified, annual, 2, eu, act360, modified, quarterly, 2,
        Identifier.of(SIMPLE_NAME_SCHEME, "EUR LIBOR 3m"), eu);
  }

  private void addJPYFixedIncomeInstruments() {
    final BusinessDayConvention modified = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Modified Following");
    final BusinessDayConvention following = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following");
    final DayCount act360 = DayCountFactory.INSTANCE.getDayCount("Actual/360");
    final DayCount act365 = DayCountFactory.INSTANCE.getDayCount("Actual/365");
    final Frequency semiAnnual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.SEMI_ANNUAL_NAME);
    //TODO looked at BSYM and the codes seem right but need to check
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY00O/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR O/N")), "JPY LIBOR O/N", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY00T/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR T/N")), "JPY LIBOR T/N", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0001W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 1w")), "JPY LIBOR 1w", act360, following,
        Period.ofDays(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0002W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 2w")), "JPY LIBOR 2w", act360, following,
        Period.ofDays(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0001M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 1m")), "JPY LIBOR 1m", act360, following,
        Period.ofMonths(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0002M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 2m")), "JPY LIBOR 2m", act360, following,
        Period.ofMonths(2), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0003M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 3m")), "JPY LIBOR 3m", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0004M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 4m")), "JPY LIBOR 4m", act360, following,
        Period.ofMonths(4), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0005M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 5m")), "JPY LIBOR 5m", act360, following,
        Period.ofMonths(5), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0006M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 6m")), "JPY LIBOR 6m", act360, following,
        Period.ofMonths(6), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0007M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 7m")), "JPY LIBOR 7m", act360, following,
        Period.ofMonths(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0008M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 8m")), "JPY LIBOR 8m", act360, following,
        Period.ofMonths(8), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0009M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 9m")), "JPY LIBOR 9m", act360, following,
        Period.ofMonths(9), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0010M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 10m")), "JPY LIBOR 10m", act360, following,
        Period.ofMonths(10), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0011M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 11m")), "JPY LIBOR 11m", act360, following,
        Period.ofMonths(11), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("JY0012M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 12m")), "JPY LIBOR 12m", act360, following,
        Period.ofMonths(12), 2);

    //TODO holiday associated with JPY swaps is Tokyo
    final Identifier jp = RegionUtils.financialRegionId("JP");
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "JPY_SWAP")), "JPY_SWAP", act365, modified, semiAnnual, 2, jp, act360, modified, semiAnnual, 2,
        Identifier.of(SIMPLE_NAME_SCHEME, "JPY LIBOR 6m"), jp);
  }

  private void addCADFixedIncomeInstruments() {
    final BusinessDayConvention modified = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Modified Following");
    final BusinessDayConvention following = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following");
    final DayCount act360 = DayCountFactory.INSTANCE.getDayCount("Actual/360");
    final DayCount act365 = DayCountFactory.INSTANCE.getDayCount("Actual/365");
    final Frequency annual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.ANNUAL_NAME);
    final Frequency semiAnnual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.SEMI_ANNUAL_NAME);
    final Frequency quarterly = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.QUARTERLY_NAME);
    //TODO looked at BSYM and the codes seem right but need to check
    //TODO check daycount
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("CDOR01M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CDOR 1m")), "CDOR 1m", act360, following, Period.ofMonths(1),
        2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("CDOR02M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CDOR 2m")), "CDOR 2m", act360, following, Period.ofMonths(2),
        2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("CDOR03M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CDOR 3m")), "CDOR 3m", act360, following, Period.ofMonths(3),
        2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("CDOR06M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CDOR 6m")), "CDOR 6m", act360, following, Period.ofMonths(6),
        2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("CDOR12M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CDOR 12m")), "CDOR 12m", act360, following,
        Period.ofMonths(12), 2);

    //TODO holiday associated with CAD swaps is Toronto
    final Identifier ca = RegionUtils.financialRegionId("CA");
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "CAD_SWAP")), "CAD_SWAP", act365, modified, semiAnnual, 0, ca, act365, modified, quarterly, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "CDOR 3m"), ca);
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "CAD_1Y_SWAP")), "CAD_1Y_SWAP", act365, modified, annual, 0, ca, act365, modified, quarterly, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "CDOR 3m"), ca);
    //TODO according to my information:
    //"Floating leg compounded quarterly at CDOR Flat paid semi-annually or annually for 1y"
    //Don't know how we're going to put that in
  }

  private void addGBPFixedIncomeInstruments() {
    final BusinessDayConvention modified = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Modified Following");
    final BusinessDayConvention following = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following");
    final DayCount act365 = DayCountFactory.INSTANCE.getDayCount("Actual/365");
    final Frequency semiAnnual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.SEMI_ANNUAL_NAME);
    final Frequency quarterly = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.QUARTERLY_NAME);
    //TODO looked at BSYM and the codes seem right but need to check
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP00O/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR O/N")), "GBP LIBOR O/N", act365, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP00T/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR T/N")), "GBP LIBOR T/N", act365, following,
        Period.ofDays(1), 1);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0001W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 1w")), "GBP LIBOR 1w", act365, following,
        Period.ofDays(7), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0002W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 2w")), "GBP LIBOR 2w", act365, following,
        Period.ofDays(14), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0001M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 1m")), "GBP LIBOR 1m", act365, modified,
        Period.ofMonths(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0002M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 2m")), "GBP LIBOR 2m", act365, modified,
        Period.ofMonths(2), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0003M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 3m")), "GBP LIBOR 3m", act365, modified,
        Period.ofMonths(3), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0004M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 4m")), "GBP LIBOR 4m", act365, modified,
        Period.ofMonths(4), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0005M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 5m")), "GBP LIBOR 5m", act365, modified,
        Period.ofMonths(5), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0006M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 6m")), "GBP LIBOR 6m", act365, modified,
        Period.ofMonths(6), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0007M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 7m")), "GBP LIBOR 7m", act365, modified,
        Period.ofMonths(7), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0008M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 8m")), "GBP LIBOR 8m", act365, modified,
        Period.ofMonths(8), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0009M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 9m")), "GBP LIBOR 9m", act365, modified,
        Period.ofMonths(9), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0010M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 10m")), "GBP LIBOR 10m", act365, modified,
        Period.ofMonths(10), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0011M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 11m")), "GBP LIBOR 11m", act365, modified,
        Period.ofMonths(11), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("BP0012M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 12m")), "GBP LIBOR 12m", act365, modified,
        Period.ofMonths(12), 0);

    //TODO holiday associated with GBP swaps is London
    final Identifier gb = RegionUtils.financialRegionId("GB");
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "GBP_SWAP")), "GBP_SWAP", act365, modified, semiAnnual, 0, gb, act365, modified, semiAnnual, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 6m"), gb);
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "GBP_1Y_SWAP")), "GBP_1Y_SWAP", act365, modified, quarterly, 0, gb, act365, modified, quarterly, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "GBP LIBOR 3m"), gb);

    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "GBP_IRFUTURE")), "GBP_IRFUTURE", act365, following, null, 2, 0.25);
  }

  private void addAUDFixedIncomeInstruments() {
    final BusinessDayConvention modified = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Modified Following");
    final BusinessDayConvention following = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following");
    final DayCount act365 = DayCountFactory.INSTANCE.getDayCount("Actual/365");
    final Frequency semiAnnual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.SEMI_ANNUAL_NAME);
    final Frequency quarterly = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.QUARTERLY_NAME);
    //TODO don't know if this is the right one - Australia also has Banker's Acceptance notes (like Canada) 
    //TODO check daycount

    Period nullPeriod = null;
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("AU0003M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "AUD 3m Bill")), "AUD 3m Bill", act365, following, nullPeriod,
        2);

    //TODO holiday associated with AUD swaps is Sydney
    final Identifier au = RegionUtils.financialRegionId("AU");
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "AUD_SWAP")), "AUD_SWAP", act365, modified, semiAnnual, 0, au, act365, modified, quarterly, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "AUD 3m Bill"), au);
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "AUD_1Y_SWAP")), "AUD_1Y_SWAP", act365, modified, quarterly, 0, au, act365, modified, quarterly, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "AUD 3m Bill"), au);
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "AUD_2Y_SWAP")), "AUD_2Y_SWAP", act365, modified, quarterly, 0, au, act365, modified, quarterly, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "AUD 3m Bill"), au);
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "AUD_3Y_SWAP")), "AUD_3Y_SWAP", act365, modified, quarterly, 0, au, act365, modified, quarterly, 0,
        Identifier.of(SIMPLE_NAME_SCHEME, "AUD 3m Bill"), au);
  }

  private void addCHFFixedIncomeInstruments() {
    final BusinessDayConvention modified = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Modified Following");
    final BusinessDayConvention following = BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following");
    final DayCount act360 = DayCountFactory.INSTANCE.getDayCount("Actual/360");
    final DayCount thirty360 = DayCountFactory.INSTANCE.getDayCount("30/360");
    final Frequency semiAnnual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.SEMI_ANNUAL_NAME);
    final Frequency annual = SimpleFrequencyFactory.INSTANCE.getFrequency(Frequency.ANNUAL_NAME);
    //TODO check that it's actually libor that we need
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF00O/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR O/N")), "CHF LIBOR O/N", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF00T/N Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR T/N")), "CHF LIBOR T/N", act360, following,
        Period.ofDays(1), 0);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0001W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 1w")), "CHF LIBOR 1w", act360, following,
        Period.ofDays(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0002W Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 2w")), "CHF LIBOR 2w", act360, following,
        Period.ofDays(14), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0001M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 1m")), "CHF LIBOR 1m", act360, following,
        Period.ofMonths(1), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0002M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 2m")), "CHF LIBOR 2m", act360, following,
        Period.ofMonths(2), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0003M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 3m")), "CHF LIBOR 3m", act360, following,
        Period.ofMonths(3), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0004M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 4m")), "CHF LIBOR 4m", act360, following,
        Period.ofMonths(4), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0005M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 5m")), "CHF LIBOR 5m", act360, following,
        Period.ofMonths(5), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0006M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 6m")), "CHF LIBOR 6m", act360, following,
        Period.ofMonths(6), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0007M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 7m")), "CHF LIBOR 7m", act360, following,
        Period.ofMonths(7), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0008M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 8m")), "CHF LIBOR 8m", act360, following,
        Period.ofMonths(8), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0009M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 9m")), "CHF LIBOR 9m", act360, following,
        Period.ofMonths(9), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0010M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 10m")), "CHF LIBOR 10m", act360, following,
        Period.ofMonths(10), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0011M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 11m")), "CHF LIBOR 11m", act360, following,
        Period.ofMonths(11), 2);
    addConventionBundle(IdentifierBundle.of(SecurityUtils.bloombergTickerSecurityId("SF0012M Index"), Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 12m")), "CHF LIBOR 12m", act360, following,
        Period.ofMonths(12), 2);

    //TODO holiday associated with CHF swaps is Zurich
    final Identifier ch = RegionUtils.financialRegionId("CH");
    //TODO check reference rate
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "CHF_SWAP")), "CHF_SWAP", thirty360, modified, annual, 2, ch, act360, modified, semiAnnual, 2,
        Identifier.of(SIMPLE_NAME_SCHEME, "CHF LIBOR 6m"), ch);
  }

  private void addUSDCAPMDefinition() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "USD_CAPM")), "USD_CAPM", "US0003M Index", "SPX Index");
  }

  private void addUSTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "US_TREASURY_BOND_CONVENTION")), "US_TREASURY_BOND_CONVENTION", true, true, 0, 1, true);
  }
  
  //TODO need to get the correct convention
  private void addUSCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "US_CORPORATE_BOND_CONVENTION")), "US_CORPORATE_BOND_CONVENTION", true, true, 0, 1, true);
  }

  private void addUSDBondFutureConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "USD_BOND_FUTURE_DELIVERABLE_CONVENTION")), "USD_BOND_FUTURE_DELIVERABLE_CONVENTION", true, true, 0, 0,
        DayCountFactory.INSTANCE.getDayCount("Actual/360"), BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following"), SimpleYieldConvention.MONEY_MARKET);
  }

  private void addGBTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "GB_TREASURY_BOND_CONVENTION")), "GB_TREASURY_BOND_CONVENTION", true, true, 7, 0, true);
  }
  
  private void addGBCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "GB_CORPORATE_BOND_CONVENTION")), "GB_CORPORATE_BOND_CONVENTION", true, true, 7, 0, true);
  }

  private void addGBPBondFutureConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "GBP_BOND_FUTURE_DELIVERABLE_CONVENTION")), "GBP_BOND_FUTURE_DELIVERABLE_CONVENTION", true, true, 7, 0,
        DayCountFactory.INSTANCE.getDayCount("Actual/365"), BusinessDayConventionFactory.INSTANCE.getBusinessDayConvention("Following"), SimpleYieldConvention.MONEY_MARKET);
  }
  
  //TODO all of the conventions named treasury need to be changed
  private void addLUTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "LU_TREASURY_BOND_CONVENTION")), "LU_TREASURY_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addLUCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "LU_CORPORATE_BOND_CONVENTION")), "LU_CORPORATE_BOND_CONVENTION", true, true, 0, 3, true);
  }
  
  //TODO all of the conventions named treasury need to be changed
  private void addHUTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "HU_TREASURY_BOND_CONVENTION")), "HU_TREASURY_BOND_CONVENTION", true, true, 0, 2, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addHUCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "HU_CORPORATE_BOND_CONVENTION")), "HU_CORPORATE_BOND_CONVENTION", true, true, 0, 2, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addITTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "IT_TREASURY_BOND_CONVENTION")), "IT_TREASURY_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addITCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "IT_CORPORATE_BOND_CONVENTION")), "IT_CORPORATE_BOND_CONVENTION", true, true, 0, 3, true);
  }
  
  //TODO all of the conventions named treasury need to be changed
  private void addDETreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "DE_TREASURY_BOND_CONVENTION")), "DE_TREASURY_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addDECorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "DE_CORPORATE_BOND_CONVENTION")), "DE_CORPORATE_BOND_CONVENTION", true, true, 0, 3, true);
  }
  
  //TODO all of the conventions named treasury need to be changed
  private void addESTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "ES_TREASURY_BOND_CONVENTION")), "ES_TREASURY_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addESCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "ES_CORPORATE_BOND_CONVENTION")), "ES_CORPORATE_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  //TODO the ex-dividend days is wrong
  private void addDKTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "DK_TREASURY_BOND_CONVENTION")), "DK_TREASURY_BOND_CONVENTION", true, true, 30, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  //TODO the ex-dividend days is wrong
  private void addDKCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "DK_CORPORATE_BOND_CONVENTION")), "DK_CORPORATE_BOND_CONVENTION", true, true, 30, 3, true);
  }
  
  //TODO all of the conventions named treasury need to be changed
  private void addNLTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "NL_TREASURY_BOND_CONVENTION")), "NL_TREASURY_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addNLCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "NL_CORPORATE_BOND_CONVENTION")), "NL_CORPORATE_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addCHTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "CH_TREASURY_BOND_CONVENTION")), "HU_TREASURY_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addCHCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "CH_CORPORATE_BOND_CONVENTION")), "HU_CORPORATE_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addPLTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "PL_TREASURY_BOND_CONVENTION")), "PL_TREASURY_BOND_CONVENTION", true, true, 10, 2, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addPLCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "PL_CORPORATE_BOND_CONVENTION")), "PL_CORPORATE_BOND_CONVENTION", true, true, 10, 2, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addFRTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "FR_TREASURY_BOND_CONVENTION")), "FR_TREASURY_BOND_CONVENTION", true, true, 0, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addFRCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "FR_CORPORATE_BOND_CONVENTION")), "FR_CORPORATE_BOND_CONVENTION", true, true, 0, 3, true);
  }
  
  //TODO all of the conventions named treasury need to be changed
  private void addBHTreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "BH_TREASURY_BOND_CONVENTION")), "BH_TREASURY_BOND_CONVENTION", true, true, 0, 1, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addBHCorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "BH_CORPORATE_BOND_CONVENTION")), "BH_CORPORATE_BOND_CONVENTION", true, true, 0, 1, true);
  }
  
  //TODO all of the conventions named treasury need to be changed
  private void addSETreasuryBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "SE_TREASURY_BOND_CONVENTION")), "SE_TREASURY_BOND_CONVENTION", true, true, 4, 3, true);
  }

  //TODO all of the conventions named treasury need to be changed
  private void addSECorporateBondConvention() {
    addConventionBundle(IdentifierBundle.of(Identifier.of(SIMPLE_NAME_SCHEME, "SE_CORPORATE_BOND_CONVENTION")), "SE_CORPORATE_BOND_CONVENTION", true, true, 4, 3, true);
  }

}
